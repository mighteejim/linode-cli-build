name: embeddings-bert
display_name: Embeddings (MPNet)
version: 0.1.0

description: >
  Sentence-transformers embedding service powered by Hugging Face Text
  Embeddings Inference (TEI). Useful for semantic search or RAG prototypes.

deploy:
  target: linode
  linode:
    image: linode/ubuntu24.04
    region_default: us-southeast
    type_default: g6-standard-2
    tags:
      - ai
      - embeddings
      - huggingface
    container:
      image: ghcr.io/huggingface/text-embeddings-inference:cpu-0.4
      internal_port: 3000
      external_port: 80
      env:
        MODEL_ID: sentence-transformers/all-mpnet-base-v2
        MAX_BATCH_SIZE: "16"
      health:
        type: http
        path: /health
        port: 3000
        success_codes: [200]
        initial_delay_seconds: 10
        timeout_seconds: 2
        max_retries: 30

env:
  required: []
  optional:
    - name: HF_TOKEN
      description: Optional Hugging Face token for gated/private models.

guidance:
  summary: |
    The embeddings API listens on port 80 (proxying TEI's port 3000). Replace {host} with your Linode hostname or IP.
  examples:
    - description: Health check
      command: curl http://{host}/health
    - description: Generate embeddings
      command: |
        curl -X POST http://{host}/embed \
          -H 'Content-Type: application/json' \
          -d '{"inputs":["Hello from Linode"]}'
